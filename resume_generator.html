<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Resume Generator</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #10b981;
            color: white;
        }

        .btn-secondary:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .resume-preview {
            background: white;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        .resume-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .resume-name {
            font-size: 36px;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .resume-title {
            font-size: 18px;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .resume-contact {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 14px;
            color: #6b7280;
        }

        .resume-section {
            margin-bottom: 30px;
        }

        .resume-section-title {
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .resume-content {
            font-size: 14px;
            line-height: 1.8;
            color: #374151;
        }

        .resume-item {
            margin-bottom: 20px;
        }

        .resume-item-title {
            font-weight: 700;
            font-size: 16px;
            color: #1f2937;
        }

        .resume-item-subtitle {
            font-weight: 600;
            color: #667eea;
            font-size: 14px;
            margin-top: 4px;
        }

        .resume-item-date {
            color: #6b7280;
            font-size: 13px;
            font-style: italic;
            margin-top: 4px;
        }

        .resume-item-description {
            margin-top: 8px;
            color: #4b5563;
            line-height: 1.6;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .skill-badge {
            background: #f3f4f6;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            color: #374151;
            font-weight: 500;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function AIResumeGenerator() {
            const [formData, setFormData] = useState({
                name: '',
                email: '',
                phone: '',
                location: '',
                jobTitle: '',
                summary: '',
                experience: '',
                education: '',
                skills: '',
                additionalInfo: ''
            });

            const [generatedResume, setGeneratedResume] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [error, setError] = useState(null);

            const handleInputChange = (field, value) => {
                setFormData(prev => ({
                    ...prev,
                    [field]: value
                }));
            };

            const generateResume = async () => {
    setIsGenerating(true);
    setError(null);

    try {
        const prompt = `Create a professional resume based on the following information. Format it as a structured JSON object with clear sections. Make the content professional and compelling.

Name: ${formData.name}
Email: ${formData.email}
Phone: ${formData.phone}
Location: ${formData.location}
Desired Job Title: ${formData.jobTitle}

Professional Summary/Objective: ${formData.summary}

Work Experience: ${formData.experience}

Education: ${formData.education}

Skills: ${formData.skills}

Additional Information: ${formData.additionalInfo}

Please return ONLY a valid JSON object (no markdown, no backticks) with this structure:
{
  "name": "Full Name",
  "jobTitle": "Professional Title",
  "contact": {
    "email": "email@example.com",
    "phone": "phone number",
    "location": "city, state"
  },
  "summary": "A compelling 2-3 sentence professional summary",
  "experience": [
    {
      "title": "Job Title",
      "company": "Company Name",
      "date": "Start Date - End Date",
      "description": "Detailed description of responsibilities and achievements"
    }
  ],
  "education": [
    {
      "degree": "Degree Name",
      "school": "School Name",
      "date": "Graduation Date",
      "details": "Additional details if any"
    }
  ],
  "skills": ["Skill 1", "Skill 2", "Skill 3", "etc"]
}`;

        const response = await fetch("/api/generate-resume", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                prompt: prompt
            })
        });

        const data = await response.json();
        
        if (data.error) {
            throw new Error(data.error.message || 'Failed to generate resume');
        }

        // Extract text from Groq response
        const textContent = data.choices[0].message.content;

        const cleanedText = textContent
            .replace(/```json/g, '')
            .replace(/```/g, '')
            .trim();

        const resumeData = JSON.parse(cleanedText);
        setGeneratedResume(resumeData);
        setIsGenerating(false);
    } catch (err) {
        console.error('Error generating resume:', err);
        setError(err.message || 'Failed to generate resume. Please try again.');
        setIsGenerating(false);
    }
};

            const downloadAsPNG = async () => {
                try {
                    const resume = document.querySelector('.resume-preview');
                    const canvas = await html2canvas(resume, {
                        scale: 3,
                        useCORS: true,
                        backgroundColor: '#ffffff'
                    });
                    const link = document.createElement('a');
                    link.download = `${generatedResume.name.replace(/\s+/g, '_')}_resume.png`;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    link.click();
                } catch (error) {
                    console.error('Export failed:', error);
                    alert('Export failed. Please try again.');
                }
            };

            const copyToClipboard = () => {
                const resumeText = document.querySelector('.resume-preview').innerText;
                navigator.clipboard.writeText(resumeText).then(() => {
                    alert('Resume copied to clipboard!');
                });
            };

            const printResume = () => {
                window.print();
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1 style={{fontSize: '48px', fontWeight: '800', marginBottom: '16px'}}>
                            <i className="fas fa-magic"></i> AI Resume Generator
                        </h1>
                        <p style={{fontSize: '20px', opacity: '0.9'}}>
                            Let AI help you create a professional resume with structured content
                        </p>
                    </div>

                    {!generatedResume ? (
                        <div className="card">
                            <h2 style={{fontSize: '24px', fontWeight: '700', marginBottom: '24px', color: '#1f2937'}}>
                                Tell us about yourself
                            </h2>

                            <div className="grid-2">
                                <div className="form-group">
                                    <label className="form-label">Full Name *</label>
                                    <input 
                                        type="text"
                                        className="form-input"
                                        value={formData.name}
                                        onChange={(e) => handleInputChange('name', e.target.value)}
                                        placeholder="John Doe"
                                    />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Email *</label>
                                    <input 
                                        type="email"
                                        className="form-input"
                                        value={formData.email}
                                        onChange={(e) => handleInputChange('email', e.target.value)}
                                        placeholder="john@example.com"
                                    />
                                </div>
                            </div>

                            <div className="grid-2">
                                <div className="form-group">
                                    <label className="form-label">Phone</label>
                                    <input 
                                        type="tel"
                                        className="form-input"
                                        value={formData.phone}
                                        onChange={(e) => handleInputChange('phone', e.target.value)}
                                        placeholder="(555) 123-4567"
                                    />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Location</label>
                                    <input 
                                        type="text"
                                        className="form-input"
                                        value={formData.location}
                                        onChange={(e) => handleInputChange('location', e.target.value)}
                                        placeholder="New York, NY"
                                    />
                                </div>
                            </div>

                            <div className="form-group">
                                <label className="form-label">Desired Job Title *</label>
                                <input 
                                    type="text"
                                    className="form-input"
                                    value={formData.jobTitle}
                                    onChange={(e) => handleInputChange('jobTitle', e.target.value)}
                                    placeholder="Software Engineer"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Professional Summary *</label>
                                <textarea 
                                    className="form-textarea"
                                    value={formData.summary}
                                    onChange={(e) => handleInputChange('summary', e.target.value)}
                                    placeholder="Brief overview of your professional background, key strengths, and career objectives..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Work Experience *</label>
                                <textarea 
                                    className="form-textarea"
                                    value={formData.experience}
                                    onChange={(e) => handleInputChange('experience', e.target.value)}
                                    placeholder="List your work experience with job titles, companies, dates, and key responsibilities..."
                                    style={{minHeight: '150px'}}
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Education *</label>
                                <textarea 
                                    className="form-textarea"
                                    value={formData.education}
                                    onChange={(e) => handleInputChange('education', e.target.value)}
                                    placeholder="List your educational background with degrees, schools, and graduation dates..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Skills *</label>
                                <textarea 
                                    className="form-textarea"
                                    value={formData.skills}
                                    onChange={(e) => handleInputChange('skills', e.target.value)}
                                    placeholder="List your relevant skills (e.g., Python, Project Management, Communication)..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Additional Information</label>
                                <textarea 
                                    className="form-textarea"
                                    value={formData.additionalInfo}
                                    onChange={(e) => handleInputChange('additionalInfo', e.target.value)}
                                    placeholder="Certifications, languages, volunteer work, awards, etc..."
                                />
                            </div>

                            {error && (
                                <div style={{padding: '12px', background: '#fee2e2', color: '#991b1b', borderRadius: '8px', marginBottom: '20px'}}>
                                    <i className="fas fa-exclamation-circle"></i> {error}
                                </div>
                            )}

                            <button 
                                className="btn btn-primary"
                                onClick={generateResume}
                                disabled={isGenerating || !formData.name || !formData.email || !formData.jobTitle}
                                style={{width: '100%', fontSize: '16px', padding: '16px'}}
                            >
                                {isGenerating ? (
                                    <>
                                        <i className="fas fa-spinner fa-spin"></i> Generating Your Resume...
                                    </>
                                ) : (
                                    <>
                                        <i className="fas fa-magic"></i> Generate Resume with AI
                                    </>
                                )}
                            </button>
                        </div>
                    ) : (
                        <>
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '20px'}}>
                                    <h2 style={{fontSize: '24px', fontWeight: '700', color: '#1f2937', marginBottom: '8px'}}>
                                        <i className="fas fa-check-circle" style={{color: '#10b981'}}></i> Your Resume is Ready!
                                    </h2>
                                    <p style={{color: '#6b7280'}}>Review and export your professionally generated resume</p>
                                </div>

                                <div className="export-buttons">
                                    <button className="btn btn-primary" onClick={downloadAsPNG}>
                                        <i className="fas fa-download"></i> Download as PNG
                                    </button>
                                    <button className="btn btn-secondary" onClick={printResume}>
                                        <i className="fas fa-print"></i> Print / Save as PDF
                                    </button>
                                    <button 
                                        className="btn" 
                                        style={{background: '#3b82f6', color: 'white'}}
                                        onClick={copyToClipboard}
                                    >
                                        <i className="fas fa-copy"></i> Copy to Clipboard
                                    </button>
                                    <button 
                                        className="btn" 
                                        style={{background: '#ef4444', color: 'white'}}
                                        onClick={() => setGeneratedResume(null)}
                                    >
                                        <i className="fas fa-redo"></i> Start Over
                                    </button>
                                </div>
                            </div>

                            <div className="resume-preview">
                                <div className="resume-header">
                                    <div className="resume-name">{generatedResume.name}</div>
                                    <div className="resume-title">{generatedResume.jobTitle}</div>
                                    <div className="resume-contact">
                                        {generatedResume.contact.email && (
                                            <span><i className="fas fa-envelope"></i> {generatedResume.contact.email}</span>
                                        )}
                                        {generatedResume.contact.phone && (
                                            <span><i className="fas fa-phone"></i> {generatedResume.contact.phone}</span>
                                        )}
                                        {generatedResume.contact.location && (
                                            <span><i className="fas fa-map-marker-alt"></i> {generatedResume.contact.location}</span>
                                        )}
                                    </div>
                                </div>

                                {generatedResume.summary && (
                                    <div className="resume-section">
                                        <div className="resume-section-title">Professional Summary</div>
                                        <div className="resume-content">{generatedResume.summary}</div>
                                    </div>
                                )}

                                {generatedResume.experience && generatedResume.experience.length > 0 && (
                                    <div className="resume-section">
                                        <div className="resume-section-title">Work Experience</div>
                                        {generatedResume.experience.map((exp, index) => (
                                            <div key={index} className="resume-item">
                                                <div className="resume-item-title">{exp.title}</div>
                                                <div className="resume-item-subtitle">{exp.company}</div>
                                                <div className="resume-item-date">{exp.date}</div>
                                                <div className="resume-item-description">{exp.description}</div>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {generatedResume.education && generatedResume.education.length > 0 && (
                                    <div className="resume-section">
                                        <div className="resume-section-title">Education</div>
                                        {generatedResume.education.map((edu, index) => (
                                            <div key={index} className="resume-item">
                                                <div className="resume-item-title">{edu.degree}</div>
                                                <div className="resume-item-subtitle">{edu.school}</div>
                                                <div className="resume-item-date">{edu.date}</div>
                                                {edu.details && (
                                                    <div className="resume-item-description">{edu.details}</div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {generatedResume.skills && generatedResume.skills.length > 0 && (
                                    <div className="resume-section">
                                        <div className="resume-section-title">Skills</div>
                                        <div className="skills-grid">
                                            {generatedResume.skills.map((skill, index) => (
                                                <div key={index} className="skill-badge">{skill}</div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </>
                    )}

                    <div style={{textAlign: 'center', marginTop: '40px'}}>
                        <a 
                            href="index.html" 
                            style={{
                                color: 'white',
                                textDecoration: 'none',
                                fontSize: '16px',
                                fontWeight: '600',
                                padding: '12px 24px',
                                background: 'rgba(255,255,255,0.2)',
                                borderRadius: '8px',
                                display: 'inline-block',
                                transition: 'all 0.2s'
                            }}
                            onMouseOver={(e) => e.target.style.background = 'rgba(255,255,255,0.3)'}
                            onMouseOut={(e) => e.target.style.background = 'rgba(255,255,255,0.2)'}
                        >
                            <i className="fas fa-arrow-left"></i> Back to Templates
                        </a>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<AIResumeGenerator />, document.getElementById('root'));
    </script>

    <style>
        @media print {
            body {
                background: white;
            }
            .card, .export-buttons, .header, a {
                display: none !important;
            }
            .resume-preview {
                box-shadow: none;
                max-width: 100%;
            }
        }
    </style>
</body>
</html>
